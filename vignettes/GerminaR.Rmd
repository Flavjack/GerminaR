---
title: "GerminaR package"
author: "Flavio Lozano-Isla, Omar Benites-Alfaro, Denise Garcia de Santana, Marli A. Ranal, Marcelo Francisco Pompelli"
date: "`r Sys.Date()`"
output: 
      rmarkdown::html_vignette:
        toc: true
        toc_depth: 4
        keep_md: true
vignette: >
  %\VignetteIndexEntry{GerminaR package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The package `GerminaR` has been developed to calculate different germination indices and graphical functions to analyze punctual and accumulative germination. For calculating the indices is necessary accumulative germination data. For more details, you can read the description of each index, the seed germination dataset and analysis in the germinar's user manual. ([GerminaQuant](https://flavjack.github.io/germinaquant/))

First we load the `GerminaR` package. It provides the `prosopis` dataset set that we will work throughout all the examples. 

## Data: GerminaR

The `prosopis` dataset contains information from an experiment containing information from germination experiment with *Prosopis juliflor* under different osmotic potentials and temperatures evaluated during 10 days.

```{r message=F, warning=FALSE}
library(GerminaR)
library(dplyr)
library(knitr)

dt <- prosopis %>% 
  mutate(across(c(nacl, temp, rep), as.factor))

```

## List of the principal functions

* `ger_summary`
* `ger_intime`
* `fplot` 

## Interactive shiny application

The function`GerminaQuant()` activates an interactive application with friendly interface for performing the different germination, statistical and graphic analysis. For activation of some function could be necessary internet connection

```{r, eval=FALSE}
GerminaQuant()
```

## Germination Variables

The function `ger_summary()`, according to the accumulative germination data, calculates several germination indices maintaining the values of each experimental unit and experiments factor for statistical analysis.

```{r}
smr <- ger_summary(SeedN = "seeds"
                   , evalName = "D"
                   , data = dt
                   )

knitr::kable(head(smr, 10),align = "c")
```

On the other hand, you can analyze each variable independently using the following germination indexes.

### Mean Germination Time

```{r, out.width="60%"}
## Mean Germination Time (MGT)

# analysis of variance

av <- aov(formula = mgt ~ nacl*temp + rep, data = smr)

# mean comparison test

mc_mgt <- ger_testcomp(aov = av
                       , comp = c("temp", "nacl")
                       , type = "snk")

# data result

mc_mgt$table %>% 
   kable(caption = "Mean germination time comparison")


# bar graphics for mean germination time

plot <- mc_mgt$table %>% 
  fplot(data = .
       , type = "bar" 
       , x = "temp"
       , y = "mgt"
       , groups = "nacl"
       , limits = c(0,9)
       , brakes = 1
       , ylab = "Mean germination time (days)"
       , xlab = "Temperature (ÂºC)"
       , glab = "NaCl (MPa)"
       , legend = "top"
       , sig = "sig"
       , error = "ste"
       , color = T
       )

plot

```

## In time analysis

`fplot()` is generic plot function optimized for publication graphs and you can add modification using `ggplot2` package.

```{r, out.width="60%"}

grt <- ger_intime(Factor = "nacl"
                  , SeedN = "seeds"
                  , evalName = "D"
                  , method = "percentage"
                  , data = dt)

plot <- grt %>% 
  fplot(data = .
        , type = "line"
        , x = "evaluation"
        , y = "mean"
        , groups = "nacl"
        , ylab = "Germination ('%')"
        , xlab = "days"
        , glab  = "NaCl (mM)"
        , sig = NULL
        , color = T
        )

plot

```
